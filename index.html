<!DOCTYPE HTML>
<html lang="en">
  <head>
    <title>Sim File Parser</title>
 
    <link rel="stylesheet" type="text/css" href="style.css">
  </head>

  <body>
	<input type="file" id="file_selector" onchange="handleFile()"></input>
	

	
	<div id="section_metadata">
		<div id="song_metadata">
			<table>
				<tr>
					<td class="metadata_label">Title</td>
					<td class="metadata">Feels just like that night</td>
				</tr>
				<tr>
					<td class="metadata_label">Subtitle</td>
					<td class="metadata">subtitle</td>
				</tr>
				<tr>
					<td class="metadata_label">Artist</td>
					<td>Eskimo &amp; Icebird</td>
				</tr>
			</table>
		</div>
	</div>
	
	<div id="draw_area">
		<table id="test" class="stepchart">
			<tr>
				<td><img class="l" src="assets/4th.png"></td>
				<td><img class="d" src="assets/4th.png"></td>
				<td><img class="u" src="assets/4th.png"></td>
				<td><img class="r" src="assets/4th.png"></td>
			</tr>
			<tr>
				<td></td> 
				<td></td>
				<td><img class="u" src="assets/4th.png"></td>
				<td><img class="r" src="assets/4th.png"></td>
			</tr>
			<tr>
				<td></td> 
				<td><img class="d" src="assets/4th.png"></td>
				<td><img class="u" src="assets/4th.png"></td>
				<td></td>
			</tr>
			<tr>
				<td></td> 
				<td><img class="d" src="assets/4th.png"></td>
				<td></td>
				<td></td>
			</tr>
		</table>
		
		<table id="targetchart" class="stepchart">
		</table>
	</div>
	
	<script src="src/util/parser.js"></script>
	<script src="src/util/stepchart-generator.js"></script>
	<script src="src/models/sim-file.js"></script>

	<script>
		function handleFile() {
			getFileContents();
		}
		
		function getFileContents() {
			input = document.getElementById('file_selector');
			file = input.files[0];
			fr = new FileReader();
			fr.onload = fileFinishedLoading;
			fr.readAsText(file);
		}
		
		function fileFinishedLoading() {       
	        var simFile = parseSimFileContents(fr.result);
           	var table = document.getElementById("targetchart");
           	var stepChartGenerator = new StepChartGenerator(simFile, "");
           	stepChartGenerator.createStepChart(6, table);
           	stepChartGenerator.attachStylesToTable(0, table);
           	console.log("created! " + table);
		 }  
        
	</script>
  </body>
</html>